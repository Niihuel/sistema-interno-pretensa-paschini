@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================
   SAFE AREA INSETS - iOS PWA Support
   Compatible with all iPhone models including:
   - iPhone 14/15/16/17 Pro/Pro Max (Dynamic Island)
   - iPhone SE, Mini, Plus, etc.
   - All iPad models
   - Works in PWA standalone mode
   ============================================ */

:root {
  /* ============================================
     BORDER RADIUS (shadcn/ui style)
     ============================================ */
  --radius: 0.625rem; /* 10px - valor base de shadcn/ui */
  
  /* Corporate gradient */
  --corp-gradient: linear-gradient(135deg, #1e293b 0%, #0f172a 50%, #020617 100%);
  
  /* Dynamic viewport height (handles iOS Safari toolbar) */
  --app-height: 100vh;
  
  /* Safe area insets - Default values with env() fallback */
  /* These are automatically provided by iOS in standalone PWA mode */
  --sat: env(safe-area-inset-top, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);
  --sar: env(safe-area-inset-right, 0px);
  
  /* Legacy safe area support (deprecated but kept for iOS 11-13) */
  --safe-area-top: env(safe-area-inset-top, 0px);
  --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-left: env(safe-area-inset-left, 0px);
  --safe-area-right: env(safe-area-inset-right, 0px);
  
  /* Theme */
  color-scheme: dark light;
  background-color: #020617;
}

/* Support for iOS 11-13 (uses constant() instead of env()) */
@supports (padding-top: constant(safe-area-inset-top)) {
  :root {
    --sat: constant(safe-area-inset-top);
    --sab: constant(safe-area-inset-bottom);
    --sal: constant(safe-area-inset-left);
    --sar: constant(safe-area-inset-right);
    
    --safe-area-top: constant(safe-area-inset-top);
    --safe-area-bottom: constant(safe-area-inset-bottom);
    --safe-area-left: constant(safe-area-inset-left);
    --safe-area-right: constant(safe-area-inset-right);
  }
}

/* Support for modern viewport units (iOS 15+) */
@supports (height: 100dvh) {
  :root {
    --app-height: 100dvh;
  }
}

/* ============================================
   BASE STYLES
   ============================================ */

* {
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

html {
  width: 100%;
  max-width: 100vw;
  height: 100%;
  height: var(--app-height);
  height: -webkit-fill-available;
  background-color: #020617;
  scroll-behavior: smooth;
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  overflow-x: hidden;
  overflow-y: auto;
}

body {
  margin: 0;
  padding: 0;
  width: 100%;
  max-width: 100vw;
  min-height: 100%;
  min-height: var(--app-height);
  min-height: -webkit-fill-available;
  background: var(--corp-gradient);
  background-attachment: fixed;
  color: #f8fafc;
  font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  overflow-x: hidden;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-x: none;
  overscroll-behavior-y: none;
  position: relative;
}

#root {
  width: 100%;
  max-width: 100vw;
  min-height: 100%;
  min-height: var(--app-height);
  min-height: -webkit-fill-available;
  display: flex;
  flex-direction: column;
  position: relative;
  isolation: isolate;
  background: transparent;
  overflow-x: hidden;
}

/* ============================================
   SAFE AREA UTILITIES
   Modern approach without pseudo-elements
   ============================================ */

/* Apply safe areas to inline (left/right) */
.safe-area-inline,
.safe-inline {
  padding-left: var(--sal);
  padding-right: var(--sar);
}

/* Apply safe areas to block (top/bottom) */
.safe-area-block,
.safe-block {
  padding-top: var(--sat);
  padding-bottom: var(--sab);
}

/* Apply all safe areas */
.safe-area-all,
.safe-all {
  padding-top: var(--sat);
  padding-bottom: var(--sab);
  padding-left: var(--sal);
  padding-right: var(--sar);
}

/* Stack layout with proper height */
.safe-area-stack {
  width: 100%;
  min-height: var(--app-height);
  display: flex;
  flex-direction: column;
}

/* Bottom spacing for fixed footers/navigation - solo safe area real */
.safe-bottom-spacing {
  padding-bottom: var(--sab);
}

/* Top spacing for fixed headers */
.safe-top-spacing {
  padding-top: max(1rem, var(--sat));
}

/* Container with max-width */
.clamped-container {
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  max-width: 1280px;
}

/* ============================================
   PWA STANDALONE MODE ADJUSTMENTS
   Only apply safe areas when in standalone
   ============================================ */

@media (display-mode: standalone) {
  /* iOS PWA standalone mode - app takes full screen */
  body {
    /* Safe areas are handled by individual components */
    /* Do NOT apply global padding here to avoid duplication */
  }
  
  /* Ensure root container respects safe areas */
  #root {
    padding-top: 0;
    padding-bottom: 0;
  }
}

@media (display-mode: fullscreen) {
  /* Fullscreen mode (rare, but supported) */
  body {
    padding: 0;
  }
}

/* ============================================
   SCROLLBAR STYLES
   ============================================ */

/* Hide scrollbars globally (iOS style) */
*::-webkit-scrollbar {
  display: none;
}

* {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* Utility class to explicitly hide scrollbar */
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* ============================================
   GLASSMORPHISM UTILITIES
   ============================================ */

.glass {
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.glass-dark {
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.glass-strong {
  background: rgba(0, 0, 0, 0.9);
  backdrop-filter: blur(24px) saturate(180%);
  -webkit-backdrop-filter: blur(24px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

/* ============================================
   ANIMATIONS (iOS Professional Style)
   ============================================ */

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slideDown {
  from {
    transform: translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes scaleIn {
  from {
    transform: scale(0.95);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.animate-fade-in-up {
  animation: fadeInUp 0.5s ease-out;
}

.animate-fade-in {
  animation: fadeIn 0.3s ease-out;
}

.animate-slide-up {
  animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.animate-slide-down {
  animation: slideDown 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.animate-scale-in {
  animation: scaleIn 0.2s cubic-bezier(0.16, 1, 0.3, 1);
}

/* Loading shimmer effect (like iOS apps) */
.shimmer {
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0.05) 0%,
    rgba(255, 255, 255, 0.15) 50%,
    rgba(255, 255, 255, 0.05) 100%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s ease-in-out infinite;
}

/* ============================================
   FOCUS & SELECTION STYLES
   ============================================ */

*:focus-visible {
  outline: 2px solid rgba(59, 130, 246, 0.5);
  outline-offset: 2px;
}

::selection {
  background: rgba(59, 130, 246, 0.3);
  color: white;
}

::-moz-selection {
  background: rgba(59, 130, 246, 0.3);
  color: white;
}

/* ============================================
   TOUCH & INTERACTION IMPROVEMENTS (iOS Style)
   ============================================ */

/* Prevent touch callout on iOS */
* {
  -webkit-touch-callout: none;
}

/* Allow selection for text elements */
p, span, h1, h2, h3, h4, h5, h6, li, td, th, label, input, textarea {
  -webkit-touch-callout: default;
  user-select: text;
  -webkit-user-select: text;
}

/* Smooth momentum scrolling */
.momentum-scroll {
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
  overscroll-behavior: contain;
}

/* iOS-style scroll containers */
.scroll-container {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  scroll-behavior: smooth;
}

/* iOS-style tactile feedback for buttons/links */
button, a, [role="button"] {
  -webkit-tap-highlight-color: transparent;
  transition: transform 0.1s ease, opacity 0.1s ease;
  cursor: pointer;
}

button:active, a:active, [role="button"]:active {
  transform: scale(0.98);
  opacity: 0.8;
}

/* Prevent scale on disabled elements */
button:disabled, a:disabled, [role="button"]:disabled {
  transform: none;
  opacity: 0.5;
  cursor: not-allowed;
}

/* iOS-style blur effects (Safari optimized) */
@supports (-webkit-backdrop-filter: blur(10px)) {
  .ios-blur {
    -webkit-backdrop-filter: blur(20px);
    backdrop-filter: blur(20px);
  }

  .ios-blur-strong {
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    backdrop-filter: blur(40px) saturate(180%);
  }

  .ios-blur-light {
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
  }
}

/* ============================================
   DEVICE-SPECIFIC OPTIMIZATIONS
   ============================================ */

/* iPhone 14/15/16/17 Pro/Pro Max - Dynamic Island */
@media (max-width: 430px) and (orientation: portrait) {
  :root {
    /* Additional top padding for Dynamic Island */
    --header-offset: max(var(--sat), 44px);
  }
}

/* iPhone SE, Mini - Smaller screens */
@media (max-width: 375px) {
  :root {
    --header-offset: max(var(--sat), 20px);
  }
}

/* Landscape mode - Different safe areas */
@media (orientation: landscape) {
  :root {
    /* In landscape, safe areas are mainly on sides */
    --header-offset: max(var(--sat), 0px);
  }
}

/* iPad - Larger screens */
@media (min-width: 768px) {
  :root {
    --header-offset: max(var(--sat), 0px);
  }
}

/* ============================================
   iOS-STYLE PROFESSIONAL UTILITIES
   ============================================ */

/* Primary button (iOS style) */
.btn-ios-primary {
  @apply px-6 py-3 rounded-xl bg-blue-600 text-white font-medium;
  @apply transition-all duration-150 active:scale-95;
  @apply shadow-lg shadow-blue-600/30;
  -webkit-tap-highlight-color: transparent;
}

.btn-ios-primary:active {
  @apply bg-blue-700;
}

.btn-ios-primary:disabled {
  @apply bg-blue-600/50 cursor-not-allowed;
  transform: none;
}

/* Secondary button (iOS style) */
.btn-ios-secondary {
  @apply px-6 py-3 rounded-xl bg-white/10 text-white font-medium;
  @apply transition-all duration-150 active:scale-95;
  @apply border border-white/20;
  -webkit-tap-highlight-color: transparent;
}

.btn-ios-secondary:active {
  @apply bg-white/20;
}

/* Card with iOS-style blur */
.card-ios {
  @apply rounded-2xl p-4;
  @apply bg-white/5 backdrop-blur-xl;
  @apply border border-white/10;
  @apply shadow-xl;
}

/* Input iOS style */
.input-ios {
  @apply px-4 py-3 rounded-xl;
  @apply bg-white/5 backdrop-blur-xl;
  @apply border border-white/20;
  @apply text-white placeholder-white/50;
  @apply transition-all duration-150;
  @apply focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30;
}

/* ============================================
   DEBUG MODE (uncomment to visualize safe areas)
   ============================================ */

/*
.safe-area-debug::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--sat);
  background: rgba(255, 0, 0, 0.3);
  z-index: 9999;
  pointer-events: none;
}

.safe-area-debug::after {
  content: '';
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: var(--sab);
  background: rgba(0, 255, 0, 0.3);
  z-index: 9999;
  pointer-events: none;
}
*/

/* ============================================
   BORDER RADIUS GLOBAL STYLES (shadcn/ui style)
   Aplicar bordes redondeados a TODOS los elementos
   Con !important para sobrescribir Tailwind
   ============================================ */

/* Botones */
button,
[type="button"],
[type="submit"],
[type="reset"],
.btn {
  border-radius: var(--radius) !important;
}

/* Inputs y formularios */
input,
textarea,
select,
.input,
.form-control {
  border-radius: var(--radius) !important;
}

/* Cards, Modals, Dialogs */
.card,
.modal,
.dialog,
.dropdown,
.popover,
.tooltip,
[role="dialog"],
[role="alertdialog"] {
  border-radius: calc(var(--radius) * 1.5) !important; /* 15px para contenedores */
}

/* Badges, Tags, Pills */
.badge,
.tag,
.pill,
.chip {
  border-radius: calc(var(--radius) * 0.8) !important; /* 8px para elementos pequeños */
}

/* Tablas */
table,
thead,
tbody,
tfoot,
th,
td {
  border-radius: var(--radius) !important;
}

/* Imágenes */
img {
  border-radius: var(--radius) !important;
}

/* Widgets del dashboard */
[data-widget-id],
.widget,
.widget-container {
  border-radius: calc(var(--radius) * 1.8) !important; /* 18px para widgets */
}

/* Navegación y menús */
nav,
.nav,
.menu,
.menu-item,
[role="menu"],
[role="menuitem"] {
  border-radius: var(--radius) !important;
}

/* Tabs */
.tab,
[role="tab"] {
  border-radius: var(--radius) !important;
}

/* Alerts, Toasts, Notifications */
.alert,
.toast,
.notification,
[role="alert"],
[role="status"] {
  border-radius: calc(var(--radius) * 1.5) !important; /* 15px */
}

/* Sidebar, Panels */
.sidebar,
.panel,
aside {
  border-radius: calc(var(--radius) * 1.5); /* 15px */
}

/* Dividers con bordes redondeados */
hr {
  border-radius: var(--radius);
}

/* Progress bars */
progress,
.progress,
.progress-bar {
  border-radius: calc(var(--radius) * 2); /* 20px para full rounded */
}

/* Checkboxes y radio buttons */
[type="checkbox"],
[type="radio"] {
  border-radius: calc(var(--radius) * 0.5); /* 5px */
}

/* Switches/toggles */
.switch,
.toggle {
  border-radius: calc(var(--radius) * 2); /* 20px */
}

/* Code blocks */
code,
pre,
.code-block {
  border-radius: var(--radius);
}

/* Scrollbars (para navegadores que los soportan visibles) */
::-webkit-scrollbar-thumb {
  border-radius: calc(var(--radius) * 2);
}

/* ============================================
   LOADING BAR ANIMATION
   Barra de progreso superior estilo NProgress
   ============================================ */

@keyframes nprogress-pulse {
  0% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
  100% {
    opacity: 1;
  }
}

#nprogress {
  pointer-events: none;
}

#nprogress .bar {
  background: linear-gradient(90deg, #3b82f6, #2563eb, #3b82f6);
  background-size: 200% 100%;
  animation: nprogress-pulse 1s ease-in-out infinite;
  position: fixed;
  z-index: 9999;
  top: 0;
  left: 0;
  width: 100%;
  height: 2px;
}

#nprogress .peg {
  display: block;
  position: absolute;
  right: 0;
  width: 100px;
  height: 100%;
  box-shadow: 0 0 10px #3b82f6, 0 0 5px #3b82f6;
  opacity: 1;
  transform: rotate(3deg) translate(0px, -4px);
}

